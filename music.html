<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Music Compositions</title>
  <link rel="stylesheet" href="music.css">
</head>
<body>

  <header class="music-header">
    <a href="website.html#music" class="back-btn">← Back</a>
    <h1 class="title">Music Compositions</h1>
  </header>

  <main class="player-shell">
    <div class="album-and-controls">
      <div class="album-wrap">
        <img class="album-art" id="albumArt" src="music/cover1.jpg" alt="Cover">
      </div>

      <div class="track-meta">
        <div class="track-title" id="trackTitle">Track 1</div>
        <div class="track-sub" id="trackSub">Artist • 3:20</div>
      </div>

      <div class="controls">
        <button id="prevBtn" class="pill">⇦</button>
        <button id="playPauseBtn" class="pill">▶</button>
        <button id="nextBtn" class="pill">⇨</button>
      </div>

      <audio id="audio"></audio>
    </div>

    <section class="carousel-shell">
      <button class="nav left" id="leftNav">❮</button>

      <div class="track-carousel" id="carousel">
      
        <button class="track-card active" data-index="0">
          <img src="music/cover/waltz.jpg" alt="">
          <span>Waltz in Air</span>
        </button>
        <button class="track-card" data-index="1">
          <img src="music/cover/wave.jpg" alt="">
          <span>Waves</span>
        </button>
        <button class="track-card" data-index="2">
          <img src="music/cover/artist.jpg" alt="">
          <span>Artist's Theme</span>
        </button>
        <button class="track-card" data-index="3">
          <img src="music/cover/marble.jpg" alt="">
          <span>Marble Ground</span>
        </button>
        <button class="track-card" data-index="4">
          <img src="music/cover/two.jpg" alt="">
          <span>The Two Towers</span>
        </button>
        <button class="track-card" data-index="5">
          <img src="music/cover/map.jpg" alt="">
          <span>Exploration of Map</span>
        </button>
        <button class="track-card" data-index="6">
          <img src="music/cover/req.jpg" alt="">
          <span>A Requiem for Adventure</span>
        </button>
        <button class="track-card" data-index="7">
          <img src="music/cover/game.jpg" alt="">
          <span>Game for Two</span>
        </button>
        <button class="track-card" data-index="8">
          <img src="music/cover/loss.jpg" alt="">
          <span>Loss</span>
        </button>
      </div>

      <button class="nav right" id="rightNav">❯</button>
    </section>
  </main>

  <script>
    const tracks = [
      { title: "Waltz in Air", artist: "2018", duration: "2:53", cover: "music/cover/waltz.jpg", src: "music/Waltz in Air.mp3" },
      { title: "Waves", artist: "2024", duration: "4:20", cover: "music/cover/wave.jpg", src: "music/waves.m4a", start: 9},
      { title: "Artist's Theme", artist: "2023", duration: "1:19", cover: "music/cover/artist.jpg", src: "music/Artist's Theme.m4a" },
      { title: "Marble Ground", artist: "2022", duration: "6:36", cover: "music/cover/marble.jpg", src: "music/Marble Ground.mp3" },
      { title: "The Two Towers", artist: "2021", duration: "1:44", cover: "music/cover/two.jpg", src: "music/The Two Towers.wav" },
      { title: "Exploration of Map", artist: "2023", duration: "2:50", cover: "music/cover/map.jpg", src: "music/exploration of map.m4a" },
      { title: "A Requiem for Adventure", artist: "2020", duration: "3:14", cover: "music/cover/req.jpg", src: "music/A Requiem for Adventure.mp3" },
      { title: "Game for Two", artist: "2023", duration: "2:02", cover: "music/cover/game.jpg", src: "music/Game for two.m4a" },
      { title: "Loss", artist: "2022", duration: "2:40", cover: "music/cover/loss.jpg", src: "music/loss.m4a" }
    ];

    const audio = document.getElementById("audio");
    const albumArt = document.getElementById("albumArt");
    const trackTitle = document.getElementById("trackTitle");
    const trackSub = document.getElementById("trackSub");
    const playPauseBtn = document.getElementById("playPauseBtn");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const carousel = document.getElementById("carousel");
    const cards = Array.from(document.querySelectorAll(".track-card"));
    const leftNav = document.getElementById("leftNav");
    const rightNav = document.getElementById("rightNav");

    let index = 0;

    function setTrack(i, autoPlay = true) {
      index = (i + tracks.length) % tracks.length;
      const t = tracks[index];
      audio.src = t.src;
      albumArt.src = t.cover;
      trackTitle.textContent = t.title;
      trackSub.textContent = `${t.artist} • ${t.duration}`;
      cards.forEach(c => c.classList.remove("active"));
      cards[index].classList.add("active");
      centerCard(index);
      if (autoPlay) {
        audio.play().catch(() => {});
      }
      updatePlayButton();
      updateSpin();
    }

    function updatePlayButton() {
      playPauseBtn.textContent = audio.paused ? "▶" : "⏸";
    }

    function updateSpin() {
      if (audio.paused) {
        albumArt.classList.remove("playing");
      } else {
        albumArt.classList.add("playing");
      }
    }

    function centerCard(i) {
      const card = cards[i];
      const wrapRect = carousel.getBoundingClientRect();
      const cardRect = card.getBoundingClientRect();
      const scrollLeft = carousel.scrollLeft + (cardRect.left - wrapRect.left) - (wrapRect.width/2 - cardRect.width/2);
      carousel.scrollTo({ left: scrollLeft, behavior: "smooth" });
    }

    playPauseBtn.addEventListener("click", () => {
      if (audio.paused) audio.play(); else audio.pause();
      updatePlayButton();
      updateSpin();
    });

    prevBtn.addEventListener("click", () => setTrack(index - 1, true));
    nextBtn.addEventListener("click", () => setTrack(index + 1, true));
    leftNav.addEventListener("click", () => setTrack(index - 1, true));
    rightNav.addEventListener("click", () => setTrack(index + 1, true));

    cards.forEach(card => {
      card.addEventListener("click", () => {
        const i = parseInt(card.dataset.index, 10);
        setTrack(i, true);
      });
    });

    audio.addEventListener("play", () => { updatePlayButton(); updateSpin(); });
    audio.addEventListener("pause", () => { updatePlayButton(); updateSpin(); });
    audio.addEventListener("ended", () => setTrack(index + 1, true));

    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowRight") setTrack(index + 1, true);
      if (e.key === "ArrowLeft") setTrack(index - 1, true);
      if (e.key === " " || e.key === "Spacebar") { e.preventDefault(); playPauseBtn.click(); }
    });

    setTrack(0, false);
  </script>
</body>
</html>
